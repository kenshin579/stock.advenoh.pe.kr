# SSR 전환 작업 - 남은 작업 요구사항 (PRD)

## 프로젝트 개요

### 현재 상태
- **기존 시스템**: Vite + React + Wouter (CSR)
- **새로운 시스템**: Next.js 15 + App Router (SSR/SSG)
- **진행률**: 80% 완료 (Phase 1-2 완료, Phase 3 테스트 중)
- **배포 타입**: 현재 Static 배포로 설정됨

### 주요 성과
- ✅ Next.js 15 App Router 설정 완료
- ✅ 모든 페이지 및 API 라우트 구현 완료
- ✅ SEO 최적화 (generateMetadata, structured data) 완료
- ✅ 90+ 블로그 포스트 마이그레이션 완료
- ✅ 시리즈 기능, 내부 링크 시스템 구현 완료

## 남은 작업 요구사항

### 1. 배포 설정 최적화 (우선순위: 높음)

#### 1.1 배포 타입 결정 및 설정
**현재 문제점:**
- `replit.toml`과 `.replit` 파일의 배포 설정이 불일치
- `replit.toml`: `deploymentTarget = "autoscale"`
- `.replit`: `deploymentTarget = "cloudrun"`
- Next.js 버전이 static export로 설정되어 있어 SSR 기능 제한

**요구사항:**
- Next.js SSR/SSG 기능을 활용할 수 있는 배포 설정으로 변경
- `next.config.ts`에서 `output: 'export'` 제거 또는 조건부 설정
- Replit의 autoscale/cloudrun 배포 타입 중 최적 선택
- 환경별 배포 설정 분리 (개발/프로덕션)

#### 1.2 빌드 스크립트 업데이트
**현재 문제점:**
- `build-static.sh`가 Vite 기반으로 작성됨
- Next.js 빌드 프로세스와 호환되지 않음

**요구사항:**
- Next.js 빌드 스크립트 작성 (`build-nextjs.sh`)
- 정적 데이터 생성 프로세스 Next.js 빌드에 통합
- 배포 호환성을 위한 파일 복사 로직 업데이트

### 2. 성능 최적화 (우선순위: 높음)

#### 2.1 Lighthouse 점수 개선
**목표:**
- 현재 Vite 버전: ~75점
- 목표: >90점

**요구사항:**
- Core Web Vitals 최적화 (LCP < 2.5초)
- 이미지 최적화 (WebP 변환, lazy loading)
- 번들 크기 최적화
- 캐싱 전략 구현

#### 2.2 Next.js 최적화
**요구사항:**
- `next.config.ts` 최적화 설정 추가
- 이미지 최적화 (`next/image` 활용)
- 폰트 최적화 (`next/font` 활용)
- 코드 스플리팅 최적화

### 3. 기능 완성도 검증 (우선순위: 중간)

#### 3.1 API 라우트 검증
**현재 구현된 API:**
- `/api/blog-posts`
- `/api/categories`
- `/api/sitemap.xml`

**검증 필요 항목:**
- API 응답 성능 테스트
- 에러 핸들링 검증
- 데이터 일관성 확인
- SEO 관련 API 동작 확인

#### 3.2 컴포넌트 호환성 검증
**요구사항:**
- 모든 UI 컴포넌트가 Next.js에서 정상 동작하는지 확인
- 클라이언트 컴포넌트와 서버 컴포넌트 분리 최적화
- 하이드레이션 이슈 해결

### 4. 데이터 관리 최적화 (우선순위: 중간)

#### 4.1 정적 데이터 생성 개선
**현재 상태:**
- `server/scripts/generateStaticData.ts`로 정적 JSON 생성
- 90+ 블로그 포스트 처리 완료

**개선 요구사항:**
- 빌드 시간 최적화
- 증분 빌드 지원
- 데이터 검증 로직 강화
- 에러 복구 메커니즘 추가

#### 4.2 콘텐츠 관리 시스템
**요구사항:**
- 새로운 블로그 포스트 추가 시 자동 빌드 트리거
- 콘텐츠 업데이트 워크플로우 최적화
- 이미지 자산 관리 개선

### 5. SEO 및 접근성 (우선순위: 중간)

#### 5.1 SEO 최적화 완성
**현재 구현된 기능:**
- generateMetadata
- structured data
- sitemap.xml
- robots.txt
- image sitemap

**추가 요구사항:**
- Open Graph 이미지 최적화
- Twitter Cards 완성
- JSON-LD 스키마 검증
- 검색엔진 크롤링 테스트

#### 5.2 접근성 개선
**요구사항:**
- ARIA 라벨 검증
- 키보드 네비게이션 지원
- 색상 대비 개선
- 스크린 리더 호환성 테스트

### 6. 테스트 및 품질 보증 (우선순위: 중간)

#### 6.1 테스트 환경 구축
**요구사항:**
- Next.js 버전과 Vite 버전 동시 테스트 환경
- 성능 비교 테스트 자동화
- 기능 회귀 테스트
- 크로스 브라우저 테스트

#### 6.2 모니터링 및 로깅
**요구사항:**
- 성능 모니터링 설정
- 에러 추적 시스템
- 사용자 행동 분석
- SEO 성과 추적

### 7. 문서화 및 유지보수 (우선순위: 낮음)

#### 7.1 기술 문서 업데이트
**요구사항:**
- Next.js 마이그레이션 가이드 작성
- 배포 프로세스 문서화
- 개발 환경 설정 가이드
- 트러블슈팅 가이드

#### 7.2 코드 정리
**요구사항:**
- 사용하지 않는 Vite 관련 코드 제거
- Next.js 최적화를 위한 코드 리팩토링
- 타입 정의 개선
- 주석 및 문서화 개선

## 구현 우선순위

### Phase 1: 배포 설정 완료 (1-2주)
1. 배포 타입 결정 및 설정
2. 빌드 스크립트 업데이트
3. 기본 배포 테스트

### Phase 2: 성능 최적화 (2-3주)
1. Lighthouse 점수 개선
2. Next.js 최적화 설정
3. 성능 테스트 및 검증

### Phase 3: 기능 완성 (1-2주)
1. API 라우트 검증
2. 컴포넌트 호환성 확인
3. 데이터 관리 최적화

### Phase 4: 품질 보증 (1주)
1. 테스트 환경 구축
2. SEO 및 접근성 최종 검증
3. 문서화 완료

## 성공 지표

### 기술적 지표
- Lighthouse 점수: >90점
- LCP: <2.5초
- 빌드 시간: <5분
- 번들 크기: <2MB (초기 로드)

### 기능적 지표
- 100% 기능 보존 (90+ 포스트, 6 시리즈)
- SEO 점수 개선
- 사용자 경험 향상
- 배포 안정성 확보

### 비즈니스 지표
- 페이지 로드 속도 개선
- 검색엔진 순위 향상
- 사용자 참여도 증가
- 유지보수 비용 절감

## 개발 도구 및 참조 자료

### Next.js 최신 코드 및 문서 참조
**MCP Context7 활용:**
- Cursor에 등록된 MCP Context7를 통해 Next.js 최신 코드와 문서에 접근 가능
- Next.js 15 App Router의 최신 기능과 패턴 참조
- 공식 문서, 예제 코드, 베스트 프랙티스 확인
- 마이그레이션 과정에서 발생하는 문제 해결을 위한 최신 가이드 참조

**사용 방법:**
- Cursor에서 MCP Context7를 통해 Next.js 관련 질의
- 최신 버전의 코드 패턴과 API 변경사항 확인
- 성능 최적화 기법과 SEO 관련 최신 가이드 참조

## 리스크 및 대응 방안

### 주요 리스크
1. **배포 복잡성 증가**: Next.js SSR 설정의 복잡성
2. **성능 저하 가능성**: SSR로 인한 초기 로드 시간 증가
3. **기능 호환성 문제**: 일부 기능이 Next.js에서 제대로 동작하지 않을 가능성
4. **버전 호환성 문제**: Next.js 15의 최신 기능과 기존 코드 간 호환성

### 대응 방안
1. **단계적 마이그레이션**: 점진적인 기능 이전으로 리스크 최소화
2. **롤백 계획**: 문제 발생 시 Vite 버전으로 즉시 복구 가능
3. **충분한 테스트**: 각 단계별 철저한 테스트로 품질 보증
4. **성능 모니터링**: 지속적인 성능 추적으로 문제 조기 발견
5. **최신 문서 참조**: MCP Context7를 통한 Next.js 최신 가이드 활용
